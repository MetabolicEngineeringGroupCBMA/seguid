<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>seguid module &#8212; seguid 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-seguid">
<span id="seguid-module"></span><h1>seguid module<a class="headerlink" href="#module-seguid" title="Link to this heading">¶</a></h1>
<p>The seguid module.</p>
<p>The seguid module supplies ten functions for calculations of checksums of
biological sequences. Som auxillary functions are also provided.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seguid.rc">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">COMPLEMENT_TABLE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seguid.rc" title="Link to this definition">¶</a></dt>
<dd><p>Reverse complement of sequence.</p>
<p>Returns the reverse complement for a DNA strand.
The default complement table accepts the ambiguous codes
suggested by IUPAC (Cornish-Bowden, 1985).</p>
<p>The optional table argument is a dictionary containing
ASCII codes for the transformation.</p>
<p>The table below was adapted from Cornish-Bowden, 1985:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Complement</p></th>
<th class="head"><p>Origin of designation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>G</p></td>
<td><p>G</p></td>
<td><p>C</p></td>
<td><p>Guanine</p></td>
</tr>
<tr class="row-odd"><td><p>A</p></td>
<td><p>A</p></td>
<td><p>T</p></td>
<td><p>Adenine</p></td>
</tr>
<tr class="row-even"><td><p>T</p></td>
<td><p>T</p></td>
<td><p>A</p></td>
<td><p>Thymine</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>C</p></td>
<td><p>G</p></td>
<td><p>Cytosine</p></td>
</tr>
<tr class="row-even"><td><p>R</p></td>
<td><p>A or G</p></td>
<td><p>Y</p></td>
<td><p>puRine</p></td>
</tr>
<tr class="row-odd"><td><p>Y</p></td>
<td><p>C or T</p></td>
<td><p>R</p></td>
<td><p>pYrimidine</p></td>
</tr>
<tr class="row-even"><td><p>M</p></td>
<td><p>A or C</p></td>
<td><p>K</p></td>
<td><p>aMino</p></td>
</tr>
<tr class="row-odd"><td><p>K</p></td>
<td><p>G or T</p></td>
<td><p>M</p></td>
<td><p>Ketone</p></td>
</tr>
<tr class="row-even"><td><p>S</p></td>
<td><p>C or G</p></td>
<td><p>S</p></td>
<td><p>Strong interaction (3 H bonds)</p></td>
</tr>
<tr class="row-odd"><td><p>W</p></td>
<td><p>A or T</p></td>
<td><p>W</p></td>
<td><p>Weak interaction (2 H bonds)</p></td>
</tr>
<tr class="row-even"><td><p>H</p></td>
<td><p>A or C or T</p></td>
<td><p>D</p></td>
<td><p>not-G, H (follows G in the alphabet)</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>C or G or T</p></td>
<td><p>V</p></td>
<td><p>not-A, B follows A</p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p>A or C or G</p></td>
<td><p>B</p></td>
<td><p>not-T (not-U), V follows U</p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>A or G or T</p></td>
<td><p>H</p></td>
<td><p>not-C, D follows C</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>G or A or T or C</p></td>
<td><p>N</p></td>
<td><p>aNy</p></td>
</tr>
</tbody>
</table>
<p>Cornish-Bowden, A. (1985). Nomenclature for incompletely specified
bases in nucleic acid sequences: recommendations 1984.
Nucleic Acids Research, 13(9), 3021–3030.
<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC341218">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC341218</a></p>
<p>The optional boolean strict argument can optionally check for
characters not defined in the translation table and raise a
ValueError if such are encountered in the sequence.</p>
<p>This implementation</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;Gat&quot;</span><span class="p">)</span>
<span class="go">&#39;atC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;GTT&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;AAC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">seguid</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;GTZ&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Character(s) Z not permitted.</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.seguid">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">seguid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">base64.standard_b64encode</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.seguid" title="Link to this definition">¶</a></dt>
<dd><p>Return the SEGUID (string) for a sequence (string).</p>
<p>Given a nucleotide or amino-acid sequence <cite>seq</cite> returns
a string containing the SEquence Globally Unique IDentifier (SEGUID).</p>
<p>The optional ´encoding` argument expects a function accepting a
byte string an returning another byte string with the encoded string.
Several such functions are available from the standard library:</p>
<p><a class="reference external" href="https://docs.python.org/3/library/base64.html">https://docs.python.org/3/library/base64.html</a></p>
<p>The SEGUID is defined as the Base64 encoded sha1 checksum calculated for
the sequence in upercase with the trailing “=” character removed. This
means that upper or lower case symbols in <cite>seq</cite> do not affect the result.</p>
<p>The resulting string is not url-safe as the Base64 encoding it potentially
produces / and + characters, carrying special meaning in a Uniform Resource
Locator (url). It can also not be used as an identifier or variable name in
programming languanges such as Python.</p>
<p>This implementation follows the original SEGUID definition by
Babnigg et al. 2006. For more information:</p>
<p>Babnigg, G., &amp; Giometti, C. S. (2006). A database of unique protein
sequence identifiers for proteome studies. Proteomics, 6(16), 4514–4522.
<a class="reference external" href="https://doi.org/10.1002/pmic.200600032">https://doi.org/10.1002/pmic.200600032</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seguid</span><span class="p">(</span><span class="s2">&quot;AT&quot;</span><span class="p">)</span>
<span class="go">&#39;Ax/RG6hzSrMEEWoCO1IWMGska+4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seguid</span><span class="p">(</span><span class="s2">&quot;at&quot;</span><span class="p">)</span>
<span class="go">&#39;Ax/RG6hzSrMEEWoCO1IWMGska+4&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.useguid">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">useguid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.useguid" title="Link to this definition">¶</a></dt>
<dd><p>Url-safe SEGUID checksum for a sequence (string).</p>
<p>This is the SEGUID checksum where the ‘+’ and ‘/’ characters of standard
Base64 encoding are replaced by ‘-’ and ‘_’, respectively following
the standard in RFC 4648 section 5.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">useguid</span><span class="p">(</span><span class="s2">&quot;AT&quot;</span><span class="p">)</span>
<span class="go">&#39;Ax_RG6hzSrMEEWoCO1IWMGska-4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seguid</span><span class="p">(</span><span class="s2">&quot;AT&quot;</span><span class="p">)</span>
<span class="go">&#39;Ax/RG6hzSrMEEWoCO1IWMGska+4&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.lseguid_blunt">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">lseguid_blunt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.lseguid_blunt" title="Link to this definition">¶</a></dt>
<dd><p>Linear SEGUID checksum (lSEGUID) for a blunt dsDNA sequence.</p>
<p>lSEGUID is a checksum for a blunt double stranded (dsDNA) DNA molecule
defined by <em>one</em> of the DNA strands in 5’-3’ (<cite>seq</cite>). The complementary
strand is deduced from the given strand.</p>
<p>For example, the seq argument <cite>GTATGC</cite> represents the blunt dsDNA
molecule depicted in the two figures below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="o">-</span><span class="n">GTATGC</span><span class="o">-</span><span class="mi">3</span>           <span class="mi">5</span><span class="o">-</span><span class="n">gcatac</span><span class="o">-</span><span class="mi">3</span>
  <span class="o">||||||</span>               <span class="o">||||||</span>
<span class="mi">3</span><span class="o">-</span><span class="n">catacg</span><span class="o">-</span><span class="mi">5</span>           <span class="mi">3</span><span class="o">-</span><span class="n">CGTATG</span><span class="o">-</span><span class="mi">5</span>
</pre></div>
</div>
<p>The lSEGUID function constructs a string made from the lexicographically
smallest of the top or bottom strands, a line break (ASCII 10) and the
other complementary strand in reverse.</p>
<p>The resulting string is used as an argument for the useguid function and
the resulting checksum is returned.</p>
<p>For the example above, gcatac &lt; GTATGC, so the string used for the
calculation will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;gcatac&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;CGTATG&quot;</span>
</pre></div>
</div>
<p>This means that lseguid_blunt(“GTATGC”) == lseguid_blunt(“gcatac”)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lseguid_blunt</span><span class="p">(</span><span class="s2">&quot;gtatgc&quot;</span><span class="p">)</span>
<span class="go">&#39;b0Xa5pLe4LNd5T8fhGWHicCI_f4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lseguid_blunt</span><span class="p">(</span><span class="s2">&quot;GTATGC&quot;</span><span class="p">)</span>
<span class="go">&#39;b0Xa5pLe4LNd5T8fhGWHicCI_f4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">useguid</span><span class="p">(</span><span class="s2">&quot;gcatac&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;CGTATG&quot;</span><span class="p">)</span>
<span class="go">&#39;b0Xa5pLe4LNd5T8fhGWHicCI_f4&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.lseguid_sticky">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">lseguid_sticky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">watson</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overhang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.lseguid_sticky" title="Link to this definition">¶</a></dt>
<dd><p>Linear SEGUID (lSEGUID) checksum for staggered linear dsDNA.</p>
<p>Calculates the lSEGUID checksum for a dsDNA sequence defined by two
strings (watson and crick) representing two complementary DNA strands
and an integer describing the stagger between the two strands in the 5’
(left) end of the molecule.</p>
<p>The overhang is defined as the amount of 3’ overhang in the 5’
side of the molecule. A molecule with 5’ overhang has a negative
overhang value.</p>
<p>See examples below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dsDNA</span>       <span class="n">overhang</span>

  <span class="n">nnn</span><span class="o">...</span>    <span class="mi">2</span>
<span class="n">nnnnn</span><span class="o">...</span>

 <span class="n">nnnn</span><span class="o">...</span>    <span class="mi">1</span>
<span class="n">nnnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>    <span class="mi">0</span>
<span class="n">nnnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>   <span class="o">-</span><span class="mi">1</span>
 <span class="n">nnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>   <span class="o">-</span><span class="mi">2</span>
  <span class="n">nnn</span><span class="o">...</span>
</pre></div>
</div>
<p>The lSEGUID_sticky function first selects the lexicographically smallest
of the top or bottom strands.</p>
<p>For positive overhang, the top strand is is left padded with the number
of whitespace characters (ASCII 32) indicated by the overhang value.
For negative overhang the reverse of the bottom strand is similarly padded.</p>
<p>The two string are joined, separated by a line break (ASCII 10).</p>
<p>The resulting string is used as an argument for the useguid function
and the result is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dsDNA</span>       <span class="n">overhang</span>  <span class="n">lseguid_sticky</span>

 <span class="n">TATGCC</span>     <span class="mi">1</span>         <span class="n">Jv9Z9JJ0IYnG</span><span class="o">-</span><span class="n">dTPBGwhDyAqnmU</span>
 <span class="o">|||||</span>
<span class="n">catacg</span>

 <span class="n">gcatac</span>     <span class="mi">1</span>         <span class="n">Jv9Z9JJ0IYnG</span><span class="o">-</span><span class="n">dTPBGwhDyAqnmU</span>
 <span class="o">|||||</span>
<span class="n">CCGTAT</span>
</pre></div>
</div>
<p>For the linear dsDNA sequence defined by Watson = “TATGCC”, Crick =”gcatac”
and overhang = 1 (see figures above), The “gcatac” strand is selected as
“gcatac” &lt; “TATGCC”.</p>
<p>Overhang is positive, so the first strand is padded to “ gcatac”.</p>
<p>A string is constructed like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot; gcatac&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;CCGTAT&quot;</span>
</pre></div>
</div>
<p>and used as and argument for the useguid function.</p>
<p>For overhang == 0, the same result is produced as would the lseguid_blunt
function.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lseguid_sticky</span><span class="p">(</span><span class="s2">&quot;TATGCC&quot;</span><span class="p">,</span> <span class="s2">&quot;gcatac&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;Jv9Z9JJ0IYnG-dTPBGwhDyAqnmU&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lseguid_sticky</span><span class="p">(</span><span class="s2">&quot;gcatac&quot;</span><span class="p">,</span> <span class="s2">&quot;TATGCC&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;Jv9Z9JJ0IYnG-dTPBGwhDyAqnmU&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">useguid</span><span class="p">(</span><span class="s2">&quot; gcatac&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;CCGTAT&quot;</span><span class="p">)</span>
<span class="go">&#39;Jv9Z9JJ0IYnG-dTPBGwhDyAqnmU&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lseguid_sticky</span><span class="p">(</span><span class="s2">&quot;gcatac&quot;</span><span class="p">,</span> <span class="s2">&quot;GTATGC&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;b0Xa5pLe4LNd5T8fhGWHicCI_f4&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.smallest_rotation">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">smallest_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seguid.smallest_rotation" title="Link to this definition">¶</a></dt>
<dd><p>Smallest rotation of a string using a fast algorithm.</p>
<p>This implementation uses the pydivsufsort python extension for the
libdivsufsort algorithm by Yuta Mori, written in C.</p>
<p>The python extension (<a class="reference external" href="https://github.com/louisabraham/pydivsufsort">https://github.com/louisabraham/pydivsufsort</a>)
is distributed as a python package installable from PyPi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pydivsufsort</span>
</pre></div>
</div>
<p>The C-code for libdivsufsort can be found here:
<a class="reference external" href="https://github.com/y-256/libdivsufsort">https://github.com/y-256/libdivsufsort</a></p>
<p>Note that this function is case-sensitive.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation</span><span class="p">(</span><span class="s2">&quot;taaa&quot;</span><span class="p">)</span>
<span class="go">&#39;aaat&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation</span><span class="p">(</span><span class="s2">&quot;abaabaaabaababaaabaaababaab&quot;</span><span class="p">)</span>
<span class="go">&#39;aaabaaababaababaabaaabaabab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation</span><span class="p">(</span><span class="s2">&quot;abaabaaabaababaaabaaaBabaab&quot;</span><span class="p">)</span>
<span class="go">&#39;Babaababaabaaabaababaaabaaa&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.smallest_rotation_py">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">smallest_rotation_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seguid.smallest_rotation_py" title="Link to this definition">¶</a></dt>
<dd><p>Smallest rotation of a string, pure Python.</p>
<p>Algorithm described in:</p>
<p>Pierre Duval, Jean. 1983. Factorizing Words
over an Ordered Alphabet. Journal of Algorithms &amp; Computational Technology
4 (4) (December 1): 363–381. and Algorithms on strings and sequences based
on Lyndon words, David Eppstein 2011.
<a class="reference external" href="https://gist.github.com/dvberkel/1950267">https://gist.github.com/dvberkel/1950267</a></p>
<p>This is a pure python implementation, considerably slower than the
smallest_rotation function above.
This should only be used if a pure python implementation is requred.</p>
<p>Note that this function is case-sensitive.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation_py</span><span class="p">(</span><span class="s2">&quot;taaa&quot;</span><span class="p">)</span>
<span class="go">&#39;aaat&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation_py</span><span class="p">(</span><span class="s2">&quot;abaabaaabaababaaabaaababaab&quot;</span><span class="p">)</span>
<span class="go">&#39;aaabaaababaababaabaaabaabab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smallest_rotation_py</span><span class="p">(</span><span class="s2">&quot;abaabaaabaababaaabaaaBabaab&quot;</span><span class="p">)</span>
<span class="go">&#39;Babaababaabaaabaababaaabaaa&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.cseguid">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">cseguid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">smallest_rotation</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.cseguid" title="Link to this definition">¶</a></dt>
<dd><p>Circular SEGUID (cSEGUID) checksum for circular dsDNA.</p>
<p>The cSEGUID is the uSEGUID checksum calculated for the lexicographically
smallest string rotation of a dsDNA sequence. Only defined for circular
sequences. The fun argument has to take a string as an argument and
return another string.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cseguid</span><span class="p">(</span><span class="s2">&quot;attt&quot;</span><span class="p">)</span>
<span class="go">&#39;oopV-6158nHJqedi8lsshIfcqYA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cseguid</span><span class="p">(</span><span class="s2">&quot;ttta&quot;</span><span class="p">)</span>
<span class="go">&#39;oopV-6158nHJqedi8lsshIfcqYA&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.tuple_from_representation">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">tuple_from_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rpr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ABCDGHKMSTVWNabcdghkmstvwn'</span> <span class="pre">+</span> <span class="pre">chr(10)</span> <span class="pre">+</span> <span class="pre">chr(32)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#seguid.tuple_from_representation" title="Link to this definition">¶</a></dt>
<dd><p>Generate a tuple from dsDNA text representation.</p>
<p>This function can generate a tuple (watson, crick, overhang)
from a dsDNA figure such as the ones depicted below. The resulting
tuple can be used as an argument for the lSEGUID_sticky or dsSEGUID
functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">5</span><span class="s1">&#39;-TATGCC-3&#39;</span>
       <span class="o">|||||</span>
   <span class="mi">3</span><span class="s1">&#39;-catacg-5&#39;</span>

<span class="ow">or</span><span class="p">:</span>

       <span class="n">TATGCC</span>
       <span class="o">|||||</span>
      <span class="n">catacg</span>

<span class="ow">or</span><span class="p">:</span>

       <span class="n">TATGCC</span>
      <span class="n">catacg</span>
</pre></div>
</div>
<p>The three figures above represent the same dsDNA molecule.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">        5&#39;-TATGCC-3&#39;</span>
<span class="gp">... </span><span class="s2">           |||||</span>
<span class="gp">... </span><span class="s2">       3&#39;-catacg-5&#39;  &quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tuple_from_representation</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">(&#39;TATGCC&#39;, &#39;gcatac&#39;, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seguid.dsseguid">
<span class="sig-prename descclassname"><span class="pre">seguid.</span></span><span class="sig-name descname"><span class="pre">dsseguid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">watson</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overhang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circular</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srfunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">smallest_rotation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">base64.urlsafe_b64encode</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#seguid.dsseguid" title="Link to this definition">¶</a></dt>
<dd><p>Double stranded SEGUID checksums for linear (lSEGUID) or circular (cSEGUID) dsDNA.</p>
<p>This function can calculate lSEGUID or cSEGUID checksums depending on the
arguments given.</p>
<p>The crick strand is an optional argument, if not given it is inferred from
the watson strand.</p>
<p>If overhang is not 0, the crick argument is required as the complementary
strand can not safely by deduced.</p>
<p>If the optional boolean circular argument is set to False, the given
sequence is interpreted as a linear double stranded DNA sequence.</p>
<p>The lSEGUID checksum is calculated as described for the lSEGUID_sticky
function.</p>
<p>If the optional boolean circular argument is set to True, the given
sequence is interpreted as a circular double stranded DNA sequence.
The overhang is assumed to be zero for circular sequences.</p>
<p>For a circular sequence dsSEGUID is the uSEGUID checksum calculated for
the lexicographically smallest of the minimum rotation of the watson and
the minimum rotation of the crick strand. The optional fun argument sets
a function for the caclulation of minimum rotation for a string. The fun
argument is expected to take a string as an argument and return another
string.</p>
<p>The rc function is used by default to deduce the complementary sequence if
needed. Another rc function can be used by setting the rc argument.</p>
<p>The dsSEGUID function uses the url-safe Base64 encoding by default, but
this can be changed using the ´encoding´ argument.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;TATGCC&quot;</span><span class="p">,</span> <span class="s2">&quot;gcatac&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;Jv9Z9JJ0IYnG-dTPBGwhDyAqnmU&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;gcatac&quot;</span><span class="p">,</span> <span class="s2">&quot;TATGCC&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;Jv9Z9JJ0IYnG-dTPBGwhDyAqnmU&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;TATGCC&quot;</span><span class="p">)</span>
<span class="go">&#39;jZwQDKGSBpAF1wOh9icAv13hC2c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;ggcata&quot;</span><span class="p">)</span>
<span class="go">&#39;jZwQDKGSBpAF1wOh9icAv13hC2c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;attt&quot;</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;oopV-6158nHJqedi8lsshIfcqYA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;ttta&quot;</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;oopV-6158nHJqedi8lsshIfcqYA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsseguid</span><span class="p">(</span><span class="s2">&quot;ttta&quot;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Circular sequence with overhang != 0.</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">seguid</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Björn F. Johansson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>